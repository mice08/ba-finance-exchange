<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ReceiveOrder">

    <typeAlias alias="ReceiveOrderData" type="com.dianping.ba.finance.exchange.api.datas.ReceiveOrderData"/>
    <resultMap id="receiveOrderData" class="ReceiveOrderData">
        <result property="roId" column="ROID"/>
        <result property="customerId" column="CustomerID"/>
        <result property="shopId" column="ShopID"/>
        <result property="businessType" column="BusinessType"/>
        <result property="receiveAmount" column="ReceiveAmount"/>
        <result property="receiveTime" column="ReceiveTime"/>
        <result property="payTime" column="PayTime"/>
        <result property="bankReceiveTime" column="BankReceiveTime"/>
        <result property="payChannel" column="PayChannel"/>
        <result property="receiveType" column="ReceiveType"/>
        <result property="bizContent" column="BizContent"/>
        <result property="tradeNo" column="TradeNo"/>
        <result property="bankID" column="BankID"/>
        <result property="addTime" column="AddTime"/>
        <result property="addLoginId" column="AddLoginID"/>
        <result property="updateTime" column="UpdateTime"/>
        <result property="updateLoginId" column="UpdateLoginID"/>
        <result property="memo" column="Memo"/>
    </resultMap>

    <insert id="insertReceiveOrderData" parameterClass="map">
        <![CDATA[
            INSERT INTO FC_ReceiveOrder
                        (CustomerID,
                         ShopID,
                         BusinessType,
                         ReceiveAmount,
                         ReceiveTime,
                         PayTime,
                         BankReceiveTime,
                         PayChannel,
                         ReceiveType,
                         BizContent,
                         TradeNo,
                         BankID,
                         Status,
                         AddTime,
                         AddLoginID,
                         UpdateTime,
                         UpdateLoginID,
                         Memo)
            VALUES      (#receiveOrderData.customerId#,
                         #receiveOrderData.shopId#,
                         #receiveOrderData.businessType#,
                         #receiveOrderData.receiveAmount#,
                         #receiveOrderData.receiveTime#,
                         #receiveOrderData.payTime#,
                         #receiveOrderData.bankReceiveTime#,
                         #receiveOrderData.payChannel#,
                         #receiveOrderData.receiveType#,
                         #receiveOrderData.bizContent#,
                         #receiveOrderData.tradeNo#,
                         #receiveOrderData.bankID#,
                         #receiveOrderData.status#,
                         #receiveOrderData.addTime#,
                         #receiveOrderData.addLoginId#,
                         #receiveOrderData.updateTime#,
                         #receiveOrderData.updateLoginId#,
                         #receiveOrderData.memo#)

 		]]>
        <selectKey resultClass="java.lang.Integer" keyProperty="roId">
            <![CDATA[
			SELECT @@IDENTITY AS id
		]]>
        </selectKey>
    </insert>


    <select id="paginateReceiveOrderList" resultMap="receiveOrderData" parameterClass="map">
     SELECT ro.ROID,
            ro.CustomerID,
            ro.ShopID,
            ro.BusinessType,
            ro.ReceiveAmount,
            ro.ReceiveTime,
            ro.PayTime,
            ro.BankReceiveTime,
            ro.PayChannel,
            ro.ReceiveType,
            ro.BizContent,
            ro.TradeNo,
            ro.BankID,
            ro.Status,
            ro.AddTime,
            ro.AddLoginID,
            ro.UpdateTime,
            ro.UpdateLoginID,
            ro.Memo
       FROM FC_ReceiveOrder ro
        <dynamic prepend="WHERE">
            <isGreaterThan property="receiveOrderSearchBean.businessType" prepend="and" compareValue="0">
                BusinessType = #receiveOrderSearchBean.businessType#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.customerId" prepend="and" compareValue="0">
                CustomerID = #receiveOrderSearchBean.customerId#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.receiveType" prepend="and" compareValue="0">
                ReceiveType = #receiveOrderSearchBean.receiveType#
            </isGreaterThan>
            <isNotNull property="receiveOrderSearchBean.receiveTimeBegin" prepend="and">
                ReceiveTime &gt;= #receiveOrderSearchBean.receiveTimeBegin#
            </isNotNull>
            <isNotNull property="receiveOrderSearchBean.receiveTimeEnd" prepend="and">
                ReceiveTime &lt;= #receiveOrderSearchBean.receiveTimeEnd#
            </isNotNull>
            <isGreaterThan property="receiveOrderSearchBean.payChannel" prepend="and" compareValue="0">
                PayChannel = #receiveOrderSearchBean.payChannel#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.status" compareValue="0" prepend="and">
                Status = #receiveOrderSearchBean.status#
            </isGreaterThan>
            <isNotNull property="receiveOrderSearchBean.bankReceiveTimeBegin" prepend="and">
                BankReceiveTime &gt;= #receiveOrderSearchBean.bankReceiveTimeBegin#
            </isNotNull>
            <isNotNull property="receiveOrderSearchBean.bankReceiveTimeEnd" prepend="and">
                BankReceiveTime &lt;= #receiveOrderSearchBean.bankReceiveTimeEnd#
            </isNotNull>
            <isGreaterThan property="receiveOrderSearchBean.bankId" prepend="and" compareValue="0">
                BankID = #receiveOrderSearchBean.bankId#
            </isGreaterThan>
        </dynamic>
        ORDER BY
        ro.AddTime DESC,
        ro.ROID ASC
    </select>

    <select id="paginateReceiveOrderList_COUNT" resultClass="int" parameterClass="map">
        SELECT COUNT(1)
        FROM FC_ReceiveOrder ro
        <dynamic prepend="WHERE">
            <isGreaterThan property="receiveOrderSearchBean.businessType" prepend="and" compareValue="0">
                BusinessType = #receiveOrderSearchBean.businessType#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.customerId" prepend="and" compareValue="0">
                CustomerID = #receiveOrderSearchBean.customerId#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.receiveType" prepend="and" compareValue="0">
                ReceiveType = #receiveOrderSearchBean.receiveType#
            </isGreaterThan>
            <isNotNull property="receiveOrderSearchBean.receiveTimeBegin" prepend="and">
                ReceiveTime &gt;= #receiveOrderSearchBean.receiveTimeBegin#
            </isNotNull>
            <isNotNull property="receiveOrderSearchBean.receiveTimeEnd" prepend="and">
                ReceiveTime &lt;= #receiveOrderSearchBean.receiveTimeEnd#
            </isNotNull>
            <isGreaterThan property="receiveOrderSearchBean.payChannel" prepend="and" compareValue="0">
                PayChannel = #receiveOrderSearchBean.payChannel#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.status" compareValue="0" prepend="and">
                Status = #receiveOrderSearchBean.status#
            </isGreaterThan>
            <isNotNull property="receiveOrderSearchBean.bankReceiveTimeBegin" prepend="and">
                BankReceiveTime &gt;= #receiveOrderSearchBean.bankReceiveTimeBegin#
            </isNotNull>
            <isNotNull property="receiveOrderSearchBean.bankReceiveTimeEnd" prepend="and">
                BankReceiveTime &lt;= #receiveOrderSearchBean.bankReceiveTimeEnd#
            </isNotNull>
            <isGreaterThan property="receiveOrderSearchBean.bankId" prepend="and" compareValue="0">
                BankID = #receiveOrderSearchBean.bankId#
            </isGreaterThan>
        </dynamic>
        ORDER BY
        ro.AddTime DESC,
        ro.ROID ASC
    </select>

    <select id="loadReceiveOrderTotalAmountByCondition" resultClass="java.math.BigDecimal" parameterClass="map">
        SELECT IFNULL(SUM(ReceiveAmount), 0) AS totalAmount
          FROM FC_ReceiveOrder
        <dynamic prepend="WHERE">
            <isGreaterThan property="receiveOrderSearchBean.businessType" prepend="and" compareValue="0">
                BusinessType = #receiveOrderSearchBean.businessType#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.customerId" prepend="and" compareValue="0">
                CustomerID = #receiveOrderSearchBean.customerId#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.receiveType" prepend="and" compareValue="0">
                ReceiveType = #receiveOrderSearchBean.receiveType#
            </isGreaterThan>
            <isNotNull property="receiveOrderSearchBean.receiveTimeBegin" prepend="and">
                ReceiveTime &gt;= #receiveOrderSearchBean.receiveTimeBegin#
            </isNotNull>
            <isNotNull property="receiveOrderSearchBean.receiveTimeEnd" prepend="and">
                ReceiveTime &lt;= #receiveOrderSearchBean.receiveTimeEnd#
            </isNotNull>
            <isGreaterThan property="receiveOrderSearchBean.payChannel" prepend="and" compareValue="0">
                PayChannel = #receiveOrderSearchBean.payChannel#
            </isGreaterThan>
            <isGreaterThan property="receiveOrderSearchBean.status" compareValue="0" prepend="and">
                Status = #receiveOrderSearchBean.status#
            </isGreaterThan>
            <isNotNull property="receiveOrderSearchBean.bankReceiveTimeBegin" prepend="and">
                BankReceiveTime &gt;= #receiveOrderSearchBean.bankReceiveTimeBegin#
            </isNotNull>
            <isNotNull property="receiveOrderSearchBean.bankReceiveTimeEnd" prepend="and">
                BankReceiveTime &lt;= #receiveOrderSearchBean.bankReceiveTimeEnd#
            </isNotNull>
            <isGreaterThan property="receiveOrderSearchBean.bankId" prepend="and" compareValue="0">
                BankID = #receiveOrderSearchBean.bankId#
            </isGreaterThan>
        </dynamic>
    </select>


</sqlMap>